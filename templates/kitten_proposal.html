{%extends "base.html"%}
{%block body %}
<div class="row">
    <div class="col-md-8">
        <h1>{{proposal.title}}</h1>
        <h4>Category: {{proposal.category}}</h4>
        <h4>Duration: {{proposal.duration}}</h4>
        <h4>Python Level: {{proposal.python_level}}</h4>
        <h4>Proposed By: {{authors}}</h4>
        <h4>Last Updated: {{proposal.updated|date}}</h4>
        <h4>Created: {{proposal.added_on|date}}</h4>
        <h3>Audience</h3>
        <p>
        {{proposal.audience}}
        </p>
        <h3>Description</h3>
        <p>
        {{proposal.description}}
        </p>
        <h3>Objectives</h3>
        <p>
        {{proposal.objectives}}
        </p>
        <h3>Detailed Abstract</h3>
        <p>
        {{proposal.abstract}}
        </p>
        <h3>Outline</h3>
        <p>
        {{proposal.outline}}
        </p>
        <h3>Additional Notes</h3>
        <p>
        {{proposal.additional_notes}}
        </p>
        <h3>Additional Requirements</h3>
        <p>
        {{proposal.additional_requirements}}
        </p>
    </div>
    <div class="col-md-4">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">Voting</h3>
            </div>
            <div class="panel-body">
                <form method="POST" action="vote/">
                <div class="radio vote-radio">
                    <label>
                        <input type="radio" name="vote" id="yea" value="yea" {%if existing_vote and existing_vote.yea %} checked="checked"{%endif%}>
                    <strong>Yea</strong> (I believe this talk meets minimal requirements for consideration as a talk at PyCon)
                    </label>
                </div>
                <div class="radio vote-radio">
                    <label>
                    <input type="radio" name="vote" id="plus-one" value="nay"{%if existing_vote and not existing_vote.yea %} checked="checked"{%endif%}>
                    <strong>Nay</strong> (I believe this talk doesn't meet the minimal threshold for consideration)
                    </label>
                </div>
                <div class="panel panel-default" {% if not existing_vote or existing_vote.yea%}style="display:none;"{%endif%} id="reasons-panel">
                      <div class="panel-body">

                    <div class="form-group">
                        <label for="reason">Vote Reason (<span id="character-count">63</span> characters left)</label>
                        <input type="text" class="form-control" id="reason" placeholder="Short Vote Reason" name="reason" {%if existing_vote and not existing_vote.yea%} value="{{existing_vote.reason}}"{%endif%}>
                        <p class="help-block">A simple reason isn't necessary, but it is encouraged!</p>
                    </div>
                    <select id="comment-reason">
                        <option disabled="disabled" selected="selected">Default Reasons for Negative Votes</option>
                        {% for r in reasons %}
                            <option>{{r}}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
                <button type="submit" class="btn btn-default">Submit</button>
                </form>
        </div>
        </div>


        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">Votes</h3>
            </div>
                <table class="table table-condensed table-striped">
            {% for v in votes %}
                <tr>
                    <td>{%if v.yea%}Yea{%else%}Nay{%endif%}</td>
                    <td>{{v.voter.display_name}}</td>
                    <td>{{v.reason}}</td>
                    <td>{{v.added_on|date}}</td>
                </tr>
            {% endfor %}
                </table>
        </div>

        <div class="panel panel-primary">
            <div class="panel-body">
                {% if unread %}
                <form method="POST" action="mark_read/">
                    <button type="submit" class="btn btn-danger">Mark Read</button>
                </form>
                {% endif %}
                {% if bookmarked %}
                    <form method="POST" action="bookmark/remove/">
                        <button type="submit" class="btn btn-default">Remove Bookmark</button>
                    </form>
                {% else %}
                    <form method="POST" action="bookmark/add/">
                        <button type="submit" class="btn btn-default">Add Bookmark</button>
                    </form>
                {% endif%}
            </div>
        </div>

{% if unread %}
        <div class="panel panel-danger">
            <div class="panel-heading">
                <h3 class="panel-title">Unread Discussion</h3>
            </div>
{% else %}
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">Discussion</h3>
            </div>
{% endif %}
            <div class="panel-body">
            {% for d in discussion %}
            {% if d.feedback %}
            <div class="panel panel-danger">
                <div class="panel-heading">
                    <h4>Sent To Proposer</h4>
                    <p>{{d.frm.display_name}} @{{d.created|date}}</p>
                </div>
            {% else %}
                {% if d.frm %}
                <div class="panel panel-warning">
                    <div class="panel-heading">{{d.frm.display_name}} @{{d.created|date}}</div>
                {%else%}
                <div class="panel panel-success">
                    <div class="panel-heading">
                    <h4>Message From Proposer</h4>
                    {{d.frm.display_name}} @{{d.created|date}}
                    </div>
                {%endif%}
            {% endif %}
            <div class="panel-body">
<pre>
{{d.body}}
</pre>
            </div>
            </div>
            {% endfor %}
            <div class="">
                <form method="POST" action="comment/">
                    <div class="form-group">
                        <label for="comment">Add Comment</label>
                        <textarea type="" class="form-control" id="comment" placeholder="Internal Comment" name="comment"></textarea>
                        <p class="help-block">Please be kind and succinct in your comments.</p>
                    </div>
                    <button type="submit" class="btn btn-default">Submit</button>
                </form>
            </div>
        </div>
        </div>








        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">Feedback</h3>
            </div>
            <div class="panel-body">
            <form method="POST" action="feedback/">
                <div class="form-group">
                    <label for="feedback">Give Author Direct Feedback</label>
                    <textarea type="" class="form-control" id="feedback" placeholder="Feedback to email author" name="feedback"></textarea>
                    <p class="help-block">Messages sent here are emailed directly to the proposal author!</p>
                </div>
                <button type="submit" class="btn btn-default">Submit</button>
            </form>
            </div>
            </div>
        <div class="panel panel-primary">
            <div class="panel-heading">Overall Progress</div>
                <table class="table table-condensed table-hover">
                    <tr><th>Votes</th><th>Proposals</th></tr>
                    {% for p in progress%}
                    <tr><td>{{p.vote_count}}</td><td>{{p.quantity}}</td></tr>
                    {%endfor%}
                </table>
        </div>
    </div>
</div>
{%endblock body%}
